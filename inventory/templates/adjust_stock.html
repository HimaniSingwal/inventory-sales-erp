{% extends 'base.html' %}

{% block title %}Adjust Stock - {{ product.name }}{% endblock %}

{% block content %}
<h2>Adjust Stock for {{ product.name }}</h2>

<p><strong>Current Quantity:</strong> {{ product.quantity }}</p>

{% if error %}
    <div class="alert alert-danger">
        {{ error }}
    </div>
{% endif %}

<form method="POST" class="mt-3">
    {% csrf_token %}

    <div class="mb-3">
        <label class="form-label">Movement Type</label>
        <select name="movement_type" class="form-select">
            <option value="in">Stock In (Add)</option>
            <option value="out">Stock Out (Reduce)</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Quantity</label>
        <input type="number" name="amount" class="form-control" min="1" required>
    </div>

    <div class="mb-3">
        <label class="form-label">Reason (optional)</label>
        <input type="text" name="reason" class="form-control" placeholder="Purchase, Sale, Damage, etc.">
    </div>

    <button type="submit" class="btn btn-success">Update Stock</button>
    <a href="{% url 'product_list' %}" class="btn btn-secondary">Back to Products</a>
</form>

<hr class="my-4">

<h4>Recent Stock Movements</h4>

{% if movements %}
    <ul class="list-group">
        {% for m in movements %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    {% if m.change > 0 %}
                        <span class="badge bg-success me-2">IN</span>
                    {% else %}
                        <span class="badge bg-danger me-2">OUT</span>
                    {% endif %}
                    <strong>{{ m.change }}</strong>
                    {% if m.reason %}
                        â€“ {{ m.reason }}
                    {% endif %}
                </div>
                <small class="text-muted">{{ m.created_at }}</small>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="text-muted">No stock movements yet.</p>
{% endif %}

{% endblock %}
